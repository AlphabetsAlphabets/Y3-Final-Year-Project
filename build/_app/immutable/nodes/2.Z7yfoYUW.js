import{p as K,b as ot,i as F,_ as nt}from"../chunks/4bz4uomn.js";import{d as at,f,a as b,s as I,o as bt}from"../chunks/DDpgsnWW.js";import{B as Z,C as V,D as P,G as c,I as i,H as k,j as t,A as m,av as st,J as B,F as tt,aE as ft,z as gt,af as J,at as lt,aF as yt}from"../chunks/Nagih0ik.js";import{s as kt,a as wt}from"../chunks/BlX3xRMM.js";import{w as it}from"../chunks/B8fJUUNV.js";import{e as ct}from"../chunks/BdrVcQUR.js";import{r as U}from"../chunks/qkCkcpST.js";import{b as X}from"../chunks/D7mLoLgg.js";import{M as vt}from"../chunks/E9bWymkK.js";import{a as ut,b as xt,l as ht,c as jt}from"../chunks/Bv_r7GIl.js";import{T as At,l as Wt}from"../chunks/xASDWjqx.js";import{a as Pt}from"../chunks/Bm68CKNN.js";var Ct=(u,e)=>{var a;(a=t(e))==null||a.showModal()},Nt=(u,e,a,n,s,r,o)=>{var w;m(e,t(a).name,!0),n(t(e)),m(s,t(a).color,!0),r(t(s)),(w=t(o))==null||w.closeModal()},Mt=async(u,e,a,n)=>{e(await ut(a.dbWorker,t(n).name,t(n).color))},St=f('<li class="option-item svelte-v8cl9o"><div class="d-flex"><button type="button" class="btn btn-outline-primary w-100 d-flex p-0 svelte-v8cl9o"><span class="project-name svelte-v8cl9o"> </span></button> <input type="color" class="form-control form-control-color svelte-v8cl9o" title="Choose project color"/></div></li>'),Dt=f('<ul class="options-list svelte-v8cl9o"></ul>'),Tt=async(u,e,a,n,s,r,o,w)=>{var d;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await ut(e.dbWorker,t(n),t(s))),r(t(n)),o(t(s)),(d=t(w))==null||d.closeModal()},Rt=f('<p> </p> <div class="new-project-section svelte-v8cl9o"><div class="color-picker-container svelte-v8cl9o"><input type="color" id="project-color" title="Choose project color" class="svelte-v8cl9o"/></div> <button type="button" class="btn btn-outline-success w-100 mt-2"> </button></div>',1),Lt=f('<input type="text" class="form-control mb-3" placeholder="Type name of project. Relaxing, work, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),Et=f('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function zt(u,e){Z(e,!0);let a=K(e,"selected",15),n=K(e,"color",15),s=K(e,"projects",15),r=P(null),o=P(""),w=P("#3498db"),d=st(()=>t(o).length===0?s():s().filter(S=>S.name.toLowerCase().includes(t(o).toLowerCase())));var D=Et(),p=V(D);p.__click=[Ct,r];var x=c(p,!0);i(p);var R=k(p,2);ot(vt(R,{title:"Select a project",children:(S,L)=>{var T=Lt(),j=V(T);U(j);var C=k(j,2);{var G=v=>{var h=Dt();ct(h,21,()=>t(d),l=>l.name,(l,_,g)=>{var M=St(),E=c(M),W=c(E);W.__click=[Nt,o,_,a,w,n,r];var O=c(W),$=c(O,!0);i(O),i(W);var H=k(W,2);U(H),H.__change=[Mt,s,e,_],i(E),i(M),B(()=>I($,t(_).name)),X(H,()=>t(_).color,et=>t(_).color=et),b(l,M)}),i(h),b(v,h)},A=v=>{var h=Rt(),l=V(h),_=c(l);i(l);var g=k(l,2),M=c(g),E=c(M);U(E),i(M);var W=k(M,2);W.__click=[Tt,e,s,o,w,a,n,r];var O=c(W);i(W),i(g),B(()=>{I(_,`No options found for "${t(o)??""}"`),I(O,`Create "${t(o)??""}"`)}),X(E,()=>t(w),$=>m(w,$)),b(v,h)};F(C,v=>{t(d).length>0||t(o)===""?v(G):v(A,!1)})}var N=k(C,2);N.__click=function(...v){var h,l;(l=(h=t(r))==null?void 0:h.closeModal)==null||l.apply(this,v)},X(j,()=>t(o),v=>m(o,v)),b(S,T)},$$slots:{default:!0}}),S=>m(r,S,!0),()=>t(r)),B(()=>I(x,t(o)||"Project")),b(u,D),tt()}at(["click","change"]);var It=(u,e)=>{var a;(a=t(e))==null||a.showModal()},Ot=(u,e,a,n)=>{var s;e(t(a).name),(s=t(n))==null||s.closeModal()},Ft=f('<span class="badge bg-success">TASK</span>'),Vt=f('<li class="option-item svelte-v93s7w"><button type="button" class="btn btn-outline-primary w-100"><!> </button></li>'),$t=f('<ul class="options-list svelte-v93s7w"></ul>'),Bt=async(u,e,a,n,s,r)=>{var o;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await xt(e.dbWorker,t(n))),s(t(n)),(o=t(r))==null||o.closeModal()},Gt=f('<p> </p> <button type="button" class="btn btn-outline-success w-100"> </button>',1),Ht=f('<input type="text" class="form-control mb-3" placeholder="Name of an activity. Reading, writing, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),Jt=f('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function Kt(u,e){Z(e,!0);let a=K(e,"selected",15),n=K(e,"taskAndActivities",15),s=P(null),r=P(""),o=st(()=>t(r).length===0?n():n().filter(x=>x.name.toLowerCase().includes(t(r).toLowerCase())));var w=Jt(),d=V(w);d.__click=[It,s];var D=c(d,!0);i(d);var p=k(d,2);ot(vt(p,{title:"Select an activity",children:(x,R)=>{var S=Ht(),L=V(S);U(L);var T=k(L,2);{var j=A=>{var N=$t();ct(N,21,()=>t(o),v=>v.name,(v,h)=>{var l=Vt(),_=c(l);_.__click=[Ot,a,h,s];var g=c(_);{var M=W=>{var O=Ft();b(W,O)};F(g,W=>{t(h).isTask&&W(M)})}var E=k(g);i(_),i(l),B(()=>I(E,` ${t(h).name??""}`)),b(v,l)}),i(N),b(A,N)},C=A=>{var N=Gt(),v=V(N),h=c(v);i(v);var l=k(v,2);l.__click=[Bt,e,n,r,a,s];var _=c(l);i(l),B(()=>{I(h,`No options found for "${t(r)??""}"`),I(_,`Create "${t(r)??""}"`)}),b(A,N)};F(T,A=>{t(o).length>0||t(r)===""?A(j):A(C,!1)})}var G=k(T,2);G.__click=function(...A){var N,v;(v=(N=t(s))==null?void 0:N.closeModal)==null||v.apply(this,A)},X(L,()=>t(r),A=>m(r,A)),b(x,S)},$$slots:{default:!0}}),x=>m(s,x,!0),()=>t(s)),B(()=>I(D,a())),b(u,w),tt()}at(["click"]);const q=ft(0),z={Running:"Running",Paused:"Paused",Stopped:"Stopped"};let dt=Date.now(),rt=Date.now(),Y=null,Q=!1;function qt(){Q=!1,q.set(0),Y=setInterval(()=>{Q||q.update(u=>u+1)},1e3),dt=Date.now()}function Qt(){Y!==null&&(clearInterval(Y),Y=null);const u=gt(q);return rt=Date.now(),q.set(0),Q=!1,[dt,rt,u]}function Ut(){Q=!0}function Xt(){Q=!1}var Yt=(u,e)=>{qt(),m(e,z.Running,!0)},Zt=f('<button type="button" class="btn btn-outline-success w-100 h-100 d-flex justify-content-center align-items-center">Start</button>'),te=(u,e)=>{Xt(),m(e,z.Running,!0)},ee=f('<button type="button" class="btn btn-outline-primary flex-grow-1" style="margin-right: 10px;">Resume</button>'),ae=(u,e)=>{Ut(),m(e,z.Paused,!0)},re=f('<button type="button" class="btn btn-outline-warning flex-grow-1" style="margin-right: 10px;">Pause</button>'),oe=async(u,e,a,n)=>{if(e.activityName.length===0||e.activityName==="Activity"){console.log(e.activityName),console.error("No activity selected.");return}let[s,r,o]=Qt();if(!t(a)){console.error("No database worker available.");return}await Pt(t(a),e.activityName,e.projectName,s,r,o),m(n,z.Stopped,!0)},ne=f('<div style="display: flex; justify-content: space-between; margin-top: 10px;"><!> <button type="button" class="btn btn-outline-danger flex-grow-1">Stop</button></div>'),se=f("<!> <!>",1);function le(u,e){Z(e,!0);let a=P(J(z.Stopped)),n=P(null);lt(async()=>{const p=await nt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);m(n,it(new p.default),!0),await t(n).initWorker()});var r=se(),o=V(r);{var w=p=>{var x=Zt();x.__click=[Yt,a],b(p,x)};F(o,p=>{t(a)===z.Stopped&&p(w)})}var d=k(o,2);{var D=p=>{var x=ne(),R=c(x);{var S=j=>{var C=ee();C.__click=[te,a],b(j,C)},L=j=>{var C=re();C.__click=[ae,a],b(j,C)};F(R,j=>{t(a)===z.Paused?j(S):j(L,!1)})}var T=k(R,2);T.__click=[oe,e,n,a],i(x),b(p,x)};F(d,p=>{(t(a)===z.Running||t(a)===z.Paused)&&p(D)})}b(u,r),tt()}at(["click"]);var ie=f("<p>Please select or create an activity to track.</p>"),ce=f('<form><div class="d-flex gap-2 mb-3"><div class="flex-grow-1"><!></div> <div class="flex-grow-1"><!></div></div> <div class="display-1 fw-bold my-3"> <span class="fs-4 align-text-top">s</span></div> <!></form>'),ve=f('<div class="d-flex flex-column align-items-center p-5"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div> <p class="mt-3 mb-0">Please wait while the app loads</p></div>'),ue=f('<div class="settings-container svelte-z6oua9"><button id="settings" class="btn btn-light rounded-circle p-2 lh-1 svelte-z6oua9"><img src="/gear.svg" alt="gear" class="svelte-z6oua9"/></button></div> <main class="container mt-5"><div class="row justify-content-center"><div class="col-md-8 col-lg-6"><!></div> <br/> <div class="col-md-8 col-lg-6 text-center"><!></div></div></main>',1);function je(u,e){Z(e,!0);const[a,n]=kt(),s=()=>wt(q,"$seconds",a);let r=P("Activity"),o=P("Project"),w=P(""),d=P(null),D=P(J([])),p=P(J([])),x=P(J([])),R=P(J([]));lt(async()=>{const l=await nt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);m(d,it(new l.default),!0),await t(d).initWorker(),m(D,await Wt(t(d)),!0),m(p,t(D).filter(g=>g.completed==0).map(g=>({id:g.id,name:g.name,isTask:!0})),!0),m(x,await ht(t(d)),!0);let _=t(x).map(g=>({id:g.id,name:g.name,isTask:!1}));t(p).push(..._),m(R,await jt(t(d)),!0)});var L=ue(),T=k(V(L),2),j=c(T),C=c(j),G=c(C);At(G,{get dbWorker(){return t(d)},get tasks(){return t(D)}}),i(C);var A=k(C,4),N=c(A);{var v=l=>{var _=ce(),g=c(_),M=c(g),E=c(M);Kt(E,{get dbWorker(){return t(d)},get selected(){return t(r)},set selected(y){m(r,y,!0)},get taskAndActivities(){return t(p)},set taskAndActivities(y){m(p,y,!0)}}),i(M);var W=k(M,2),O=c(W);zt(O,{get dbWorker(){return t(d)},get selected(){return t(o)},set selected(y){m(o,y,!0)},get color(){return t(w)},set color(y){m(w,y,!0)},get projects(){return t(R)},set projects(y){m(R,y,!0)}}),i(W),i(g);var $=k(g,2),H=c($,!0);yt(),i($);var et=k($,2);{var _t=y=>{var pt=ie();b(y,pt)},mt=y=>{le(y,{get activityName(){return t(r)},get projectName(){return t(o)}})};F(et,y=>{t(r)==="Activity"?y(_t):y(mt,!1)})}i(_),B(()=>I(H,s())),bt("submit",_,y=>y.preventDefault()),b(l,_)},h=l=>{var _=ve();b(l,_)};F(N,l=>{t(d)?l(v):l(h,!1)})}i(A),i(j),i(T),b(u,L),tt(),n()}export{je as component};
