import{p as $,b as st,i as O,_ as lt}from"../chunks/DM5Mwux_.js";import{d as ot,f as g,a as f,p as ft}from"../chunks/BWJJ8Nft.js";import{A as Z,B as E,C as P,F as u,H as c,G as x,j as t,z as _,aB as nt,I as F,D as tt,aK as gt,al as J,az as it,aL as yt}from"../chunks/DtPNIzaT.js";import{s as z}from"../chunks/D7PZLOxe.js";import{s as kt,a as wt}from"../chunks/B-vV4sKl.js";import{w as ct}from"../chunks/B8fJUUNV.js";import{e as vt}from"../chunks/C9ip0I7f.js";import{r as Q}from"../chunks/Bsg0kGkC.js";import{b as U,l as xt,T as ht}from"../chunks/Ct-RL1iB.js";import{M as ut}from"../chunks/en4OGELR.js";import{a as dt,b as jt,l as At,c as Wt}from"../chunks/Bv_r7GIl.js";import{a as Pt}from"../chunks/Bm68CKNN.js";var Ct=(p,e)=>{var a;(a=t(e))==null||a.showModal()},Nt=(p,e,a,n,s,r,o)=>{var h;_(e,t(a).name,!0),n(t(e)),_(s,t(a).color,!0),r(t(s)),(h=t(o))==null||h.closeModal()},Mt=async(p,e,a,n)=>{e(await dt(a.dbWorker,t(n).name,t(n).color))},St=g('<li class="option-item svelte-v8cl9o"><div class="d-flex"><button type="button" class="btn btn-outline-primary w-100 d-flex p-0 svelte-v8cl9o"><span class="project-name svelte-v8cl9o"> </span></button> <input type="color" class="form-control form-control-color svelte-v8cl9o" title="Choose project color"/></div></li>'),Tt=g('<ul class="options-list svelte-v8cl9o"></ul>'),Dt=async(p,e,a,n,s,r,o,h)=>{var d;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await dt(e.dbWorker,t(n),t(s))),r(t(n)),o(t(s)),(d=t(h))==null||d.closeModal()},Rt=g('<p> </p> <div class="new-project-section svelte-v8cl9o"><div class="color-picker-container svelte-v8cl9o"><input type="color" id="project-color" title="Choose project color" class="svelte-v8cl9o"/></div> <button type="button" class="btn btn-outline-success w-100 mt-2"> </button></div>',1),Lt=g('<input type="text" class="form-control mb-3" placeholder="Type name of project. Relaxing, work, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),It=g('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function zt(p,e){Z(e,!0);let a=$(e,"selected",15),n=$(e,"color",15),s=$(e,"projects",15),r=P(null),o=P(""),h=P("#3498db"),d=nt(()=>t(o).length===0?s():s().filter(C=>C.name.toLowerCase().includes(t(o).toLowerCase())));var T=It(),y=E(T);y.__click=[Ct,r];var k=u(y,!0);c(y);var B=x(y,2);st(ut(B,{title:"Select a project",children:(C,K)=>{var R=Lt(),j=E(R);Q(j);var N=x(j,2);{var G=v=>{var l=Tt();vt(l,21,()=>t(d),i=>i.name,(i,w,S)=>{var m=St(),D=u(m),W=u(D);W.__click=[Nt,o,w,a,h,n,r];var L=u(W),H=u(L,!0);c(L),c(W);var V=x(W,2);Q(V),V.__change=[Mt,s,e,w],c(D),c(m),F(()=>z(H,t(w).name)),U(V,()=>t(w).color,et=>t(w).color=et),f(i,m)}),c(l),f(v,l)},A=v=>{var l=Rt(),i=E(l),w=u(i);c(i);var S=x(i,2),m=u(S),D=u(m);Q(D),c(m);var W=x(m,2);W.__click=[Dt,e,s,o,h,a,n,r];var L=u(W);c(W),c(S),F(()=>{z(w,`No options found for "${t(o)??""}"`),z(L,`Create "${t(o)??""}"`)}),U(D,()=>t(h),H=>_(h,H)),f(v,l)};O(N,v=>{t(d).length>0||t(o)===""?v(G):v(A,!1)})}var M=x(N,2);M.__click=function(...v){var l,i;(i=(l=t(r))==null?void 0:l.closeModal)==null||i.apply(this,v)},U(j,()=>t(o),v=>_(o,v)),f(C,R)},$$slots:{default:!0}}),C=>_(r,C,!0),()=>t(r)),F(()=>z(k,t(o)||"Project")),f(p,T),tt()}ot(["click","change"]);var Et=(p,e)=>{var a;(a=t(e))==null||a.showModal()},Ot=(p,e,a,n)=>{var s;e(t(a).name),(s=t(n))==null||s.closeModal()},Bt=g('<span class="badge bg-success">TASK</span>'),Kt=g('<li class="option-item svelte-v93s7w"><button type="button" class="btn btn-outline-primary w-100"><!> </button></li>'),Vt=g('<ul class="options-list svelte-v93s7w"></ul>'),Ft=async(p,e,a,n,s,r)=>{var o;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await jt(e.dbWorker,t(n))),s(t(n)),(o=t(r))==null||o.closeModal()},Gt=g('<p> </p> <button type="button" class="btn btn-outline-success w-100"> </button>',1),Ht=g('<input type="text" class="form-control mb-3" placeholder="Name of an activity. Reading, writing, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),$t=g('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function qt(p,e){Z(e,!0);let a=$(e,"selected",15),n=$(e,"taskAndActivities",15),s=P(null),r=P(""),o=nt(()=>t(r).length===0?n():n().filter(k=>k.name.toLowerCase().includes(t(r).toLowerCase())));var h=$t(),d=E(h);d.__click=[Et,s];var T=u(d,!0);c(d);var y=x(d,2);st(ut(y,{title:"Select an activity",children:(k,B)=>{var C=Ht(),K=E(C);Q(K);var R=x(K,2);{var j=A=>{var M=Vt();vt(M,21,()=>t(o),v=>v.name,(v,l)=>{var i=Kt(),w=u(i);w.__click=[Ot,a,l,s];var S=u(w);{var m=W=>{var L=Bt();f(W,L)};O(S,W=>{t(l).isTask&&W(m)})}var D=x(S);c(w),c(i),F(()=>z(D,` ${t(l).name??""}`)),f(v,i)}),c(M),f(A,M)},N=A=>{var M=Gt(),v=E(M),l=u(v);c(v);var i=x(v,2);i.__click=[Ft,e,n,r,a,s];var w=u(i);c(i),F(()=>{z(l,`No options found for "${t(r)??""}"`),z(w,`Create "${t(r)??""}"`)}),f(A,M)};O(R,A=>{t(o).length>0||t(r)===""?A(j):A(N,!1)})}var G=x(R,2);G.__click=function(...A){var M,v;(v=(M=t(s))==null?void 0:M.closeModal)==null||v.apply(this,A)},U(K,()=>t(r),A=>_(r,A)),f(k,C)},$$slots:{default:!0}}),k=>_(s,k,!0),()=>t(s)),F(()=>z(T,a())),f(p,h),tt()}ot(["click"]);const Y=gt(0),I={Running:"Running",Paused:"Paused",Stopped:"Stopped"};let rt=-1,at=-1,X=null,q=!1;function Jt(){q=!1,Y.set(0),X=setInterval(()=>{q||Y.update(p=>p+1)},1e3),rt=Date.now()}function Qt(){return X!==null&&(clearInterval(X),X=null),at=Date.now(),Y.set(0),q=!1,[rt,at,at-rt]}function Ut(){q=!0}function Xt(){q=!1}var Yt=(p,e)=>{Jt(),_(e,I.Running,!0)},Zt=g('<button type="button" class="btn btn-outline-success w-100 h-100 d-flex justify-content-center align-items-center">Start</button>'),te=(p,e)=>{Xt(),_(e,I.Running,!0)},ee=g('<button type="button" class="btn btn-outline-primary flex-grow-1" style="margin-right: 10px;">Resume</button>'),ae=(p,e)=>{Ut(),_(e,I.Paused,!0)},re=g('<button type="button" class="btn btn-outline-warning flex-grow-1" style="margin-right: 10px;">Pause</button>'),oe=async(p,e,a,n)=>{if(e.activityName.length===0||e.activityName==="Activity"){console.log(e.activityName),console.error("No activity selected.");return}let[s,r,o]=Qt();if(!t(a)){console.error("No database worker available.");return}await Pt(t(a),e.activityName,e.projectName,o,s,r),_(n,I.Stopped,!0)},ne=g('<div style="display: flex; justify-content: space-between; margin-top: 10px;"><!> <button type="button" class="btn btn-outline-danger flex-grow-1">Stop</button></div>'),se=g("<!> <!>",1);function le(p,e){Z(e,!0);let a=P(J(I.Stopped)),n=P(null);it(async()=>{const y=await lt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);_(n,ct(new y.default),!0),await t(n).initWorker()});var r=se(),o=E(r);{var h=y=>{var k=Zt();k.__click=[Yt,a],f(y,k)};O(o,y=>{t(a)===I.Stopped&&y(h)})}var d=x(o,2);{var T=y=>{var k=ne(),B=u(k);{var C=j=>{var N=ee();N.__click=[te,a],f(j,N)},K=j=>{var N=re();N.__click=[ae,a],f(j,N)};O(B,j=>{t(a)===I.Paused?j(C):j(K,!1)})}var R=x(B,2);R.__click=[oe,e,n,a],c(k),f(y,k)};O(d,y=>{(t(a)===I.Running||t(a)===I.Paused)&&y(T)})}f(p,r),tt()}ot(["click"]);var ie=g("<p>Please select or create an activity to track.</p>"),ce=g('<!> <br/> <form><div class="d-flex gap-2 mb-3"><div class="flex-grow-1"><!></div> <div class="flex-grow-1"><!></div></div> <div class="display-1 fw-bold my-3"> <span class="fs-4 align-text-top">s</span></div> <!></form>',1),ve=g('<div class="d-flex flex-column align-items-center p-5"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div> <p class="mt-3 mb-0">Please wait while the app loads</p></div>'),ue=g('<div class="settings-container svelte-z6oua9"><button id="settings" class="btn btn-light rounded-circle p-2 lh-1 svelte-z6oua9"><img src="/gear.svg" alt="gear" class="svelte-z6oua9"/></button></div> <main class="container mt-5"><div class="row justify-content-center"><div class="col-md-8 col-lg-6 text-center"><!></div></div></main>',1);function je(p,e){Z(e,!0);const[a,n]=kt(),s=()=>wt(Y,"$seconds",a);let r=P("Activity"),o=P("Project"),h=P(""),d=P(null),T=P(J([])),y=P(J([])),k=P(J([]));const B=(l,i)=>{const w=l.filter(m=>m.completed==0).map(m=>({id:m.id,name:m.name,isTask:!0})),S=i.map(m=>({id:m.id,name:m.name,isTask:!1}));return[...w,...S]};let C=nt(()=>B(t(T),t(y)));it(async()=>{const l=await lt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);_(d,ct(new l.default),!0),await t(d).initWorker(),_(T,await xt(t(d)),!0),_(y,await At(t(d)),!0),_(k,await Wt(t(d)),!0)});var R=ue(),j=x(E(R),2),N=u(j),G=u(N),A=u(G);{var M=l=>{var i=ce(),w=E(i);ht(w,{get dbWorker(){return t(d)},get tasks(){return t(T)},set tasks(b){_(T,b,!0)}});var S=x(w,4),m=u(S),D=u(m),W=u(D);qt(W,{get dbWorker(){return t(d)},get selected(){return t(r)},set selected(b){_(r,b,!0)},get taskAndActivities(){return t(C)},set taskAndActivities(b){_(C,b,!0)}}),c(D);var L=x(D,2),H=u(L);zt(H,{get dbWorker(){return t(d)},get selected(){return t(o)},set selected(b){_(o,b,!0)},get color(){return t(h)},set color(b){_(h,b,!0)},get projects(){return t(k)},set projects(b){_(k,b,!0)}}),c(L),c(m);var V=x(m,2),et=u(V,!0);yt(),c(V);var _t=x(V,2);{var mt=b=>{var bt=ie();f(b,bt)},pt=b=>{le(b,{get activityName(){return t(r)},get projectName(){return t(o)}})};O(_t,b=>{t(r)==="Activity"?b(mt):b(pt,!1)})}c(S),F(()=>z(et,s())),ft("submit",S,b=>b.preventDefault()),f(l,i)},v=l=>{var i=ve();f(l,i)};O(A,l=>{t(d)?l(M):l(v,!1)})}c(G),c(N),c(j),f(p,R),tt(),n()}export{je as component};
