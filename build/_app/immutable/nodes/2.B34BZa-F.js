import{p as q,b as ot,i as V,_ as nt}from"../chunks/Blysb1Co.js";import{d as at,f,a as m,s as I,g as mt}from"../chunks/BLYeUyYq.js";import{A as Z,B as $,I as P,F as c,G as i,D as k,j as t,z as p,ay as st,H as F,C as tt,az as ft,y as gt,ak as K,aw as lt,aA as yt}from"../chunks/Babm-7jm.js";import{s as kt,a as wt}from"../chunks/Aas0eYTe.js";import{M as it,w as ct}from"../chunks/DQCzdT6O.js";import{r as U,e as vt}from"../chunks/rWHTdQe2.js";import{b as X,T as xt,l as ht}from"../chunks/BPb4tRUs.js";import{a as ut,b as jt,c as At,l as Wt,d as Pt}from"../chunks/F2MYinTD.js";var Ct=(u,e)=>{var a;(a=t(e))==null||a.showModal()},Nt=(u,e,a,n,s,r,o)=>{var w;p(e,t(a).name,!0),n(t(e)),p(s,t(a).color,!0),r(t(s)),(w=t(o))==null||w.closeModal()},Mt=async(u,e,a,n)=>{e(await ut(a.dbWorker,t(n).name,t(n).color))},St=f('<li class="option-item svelte-v8cl9o"><div class="d-flex"><button type="button" class="btn btn-outline-primary w-100 d-flex p-0 svelte-v8cl9o"><span class="project-name svelte-v8cl9o"> </span></button> <input type="color" class="form-control form-control-color svelte-v8cl9o" title="Choose project color"/></div></li>'),Dt=f('<ul class="options-list svelte-v8cl9o"></ul>'),Tt=async(u,e,a,n,s,r,o,w)=>{var d;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await ut(e.dbWorker,t(n),t(s))),r(t(n)),o(t(s)),(d=t(w))==null||d.closeModal()},Rt=f('<p> </p> <div class="new-project-section svelte-v8cl9o"><div class="color-picker-container svelte-v8cl9o"><input type="color" id="project-color" title="Choose project color" class="svelte-v8cl9o"/></div> <button type="button" class="btn btn-outline-success w-100 mt-2"> </button></div>',1),Lt=f('<input type="text" class="form-control mb-3" placeholder="Type name of project. Relaxing, work, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),zt=f('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function Et(u,e){Z(e,!0);let a=q(e,"selected",15),n=q(e,"color",15),s=q(e,"projects",15),r=P(null),o=P(""),w=P("#3498db"),d=st(()=>t(o).length===0?s():s().filter(S=>S.name.toLowerCase().includes(t(o).toLowerCase())));var D=zt(),b=$(D);b.__click=[Ct,r];var x=c(b,!0);i(b);var R=k(b,2);ot(it(R,{title:"Select a project",children:(S,L)=>{var T=Lt(),j=$(T);U(j);var C=k(j,2);{var G=v=>{var h=Dt();vt(h,21,()=>t(d),l=>l.name,(l,_,g)=>{var M=St(),z=c(M),W=c(z);W.__click=[Nt,o,_,a,w,n,r];var O=c(W),B=c(O,!0);i(O),i(W);var H=k(W,2);U(H),H.__change=[Mt,s,e,_],i(z),i(M),F(()=>I(B,t(_).name)),X(H,()=>t(_).color,et=>t(_).color=et),m(l,M)}),i(h),m(v,h)},A=v=>{var h=Rt(),l=$(h),_=c(l);i(l);var g=k(l,2),M=c(g),z=c(M);U(z),i(M);var W=k(M,2);W.__click=[Tt,e,s,o,w,a,n,r];var O=c(W);i(W),i(g),F(()=>{I(_,`No options found for "${t(o)??""}"`),I(O,`Create "${t(o)??""}"`)}),X(z,()=>t(w),B=>p(w,B)),m(v,h)};V(C,v=>{t(d).length>0||t(o)===""?v(G):v(A,!1)})}var N=k(C,2);N.__click=function(...v){var h,l;(l=(h=t(r))==null?void 0:h.closeModal)==null||l.apply(this,v)},X(j,()=>t(o),v=>p(o,v)),m(S,T)},$$slots:{default:!0}}),S=>p(r,S,!0),()=>t(r)),F(()=>I(x,t(o)||"Project")),m(u,D),tt()}at(["click","change"]);var It=(u,e)=>{var a;(a=t(e))==null||a.showModal()},Ot=(u,e,a,n)=>{var s;e(t(a).name),(s=t(n))==null||s.closeModal()},Vt=f('<span class="badge bg-success">TASK</span>'),$t=f('<li class="option-item svelte-v93s7w"><button type="button" class="btn btn-outline-primary w-100"><!> </button></li>'),Bt=f('<ul class="options-list svelte-v93s7w"></ul>'),Ft=async(u,e,a,n,s,r)=>{var o;if(!e.dbWorker){console.error("dbWorker not ready yet.");return}a(await jt(e.dbWorker,t(n))),s(t(n)),(o=t(r))==null||o.closeModal()},Gt=f('<p> </p> <button type="button" class="btn btn-outline-success w-100"> </button>',1),Ht=f('<input type="text" class="form-control mb-3" placeholder="Name of an activity. Reading, writing, etc."/> <!> <button type="button" class="btn btn-secondary w-100 mt-3">Cancel</button>',1),Kt=f('<button id="activity select" type="button" class="btn btn-outline-primary w-100"> </button> <!>',1);function qt(u,e){Z(e,!0);let a=q(e,"selected",15),n=q(e,"taskAndActivities",15),s=P(null),r=P(""),o=st(()=>t(r).length===0?n():n().filter(x=>x.name.toLowerCase().includes(t(r).toLowerCase())));var w=Kt(),d=$(w);d.__click=[It,s];var D=c(d,!0);i(d);var b=k(d,2);ot(it(b,{title:"Select an activity",children:(x,R)=>{var S=Ht(),L=$(S);U(L);var T=k(L,2);{var j=A=>{var N=Bt();vt(N,21,()=>t(o),v=>v.name,(v,h)=>{var l=$t(),_=c(l);_.__click=[Ot,a,h,s];var g=c(_);{var M=W=>{var O=Vt();m(W,O)};V(g,W=>{t(h).isTask&&W(M)})}var z=k(g);i(_),i(l),F(()=>I(z,` ${t(h).name??""}`)),m(v,l)}),i(N),m(A,N)},C=A=>{var N=Gt(),v=$(N),h=c(v);i(v);var l=k(v,2);l.__click=[Ft,e,n,r,a,s];var _=c(l);i(l),F(()=>{I(h,`No options found for "${t(r)??""}"`),I(_,`Create "${t(r)??""}"`)}),m(A,N)};V(T,A=>{t(o).length>0||t(r)===""?A(j):A(C,!1)})}var G=k(T,2);G.__click=function(...A){var N,v;(v=(N=t(s))==null?void 0:N.closeModal)==null||v.apply(this,A)},X(L,()=>t(r),A=>p(r,A)),m(x,S)},$$slots:{default:!0}}),x=>p(s,x,!0),()=>t(s)),F(()=>I(D,a())),m(u,w),tt()}at(["click"]);const J=ft(0),E={Running:"Running",Paused:"Paused",Stopped:"Stopped"};let dt=Date.now(),rt=Date.now(),Y=null,Q=!1;function Jt(){Q=!1,J.set(0),Y=setInterval(()=>{Q||J.update(u=>u+1)},1e3),dt=Date.now()}function Qt(){Y!==null&&(clearInterval(Y),Y=null);const u=gt(J);return rt=Date.now(),J.set(0),Q=!1,[dt,rt,u]}function Ut(){Q=!0}function Xt(){Q=!1}var Yt=(u,e)=>{Jt(),p(e,E.Running,!0)},Zt=f('<button type="button" class="btn btn-outline-success w-100 h-100 d-flex justify-content-center align-items-center">Start</button>'),te=(u,e)=>{Xt(),p(e,E.Running,!0)},ee=f('<button type="button" class="btn btn-outline-primary flex-grow-1" style="margin-right: 10px;">Resume</button>'),ae=(u,e)=>{Ut(),p(e,E.Paused,!0)},re=f('<button type="button" class="btn btn-outline-warning flex-grow-1" style="margin-right: 10px;">Pause</button>'),oe=async(u,e,a,n)=>{if(e.activityName.length===0||e.activityName==="Activity"){console.log(e.activityName),console.error("No activity selected.");return}let[s,r,o]=Qt();if(!t(a)){console.error("No database worker available.");return}await At(t(a),e.activityName,e.projectName,s,r,o),p(n,E.Stopped,!0)},ne=f('<div style="display: flex; justify-content: space-between; margin-top: 10px;"><!> <button type="button" class="btn btn-outline-danger flex-grow-1">Stop</button></div>'),se=f("<!> <!>",1);function le(u,e){Z(e,!0);let a=P(K(E.Stopped)),n=P(null);lt(async()=>{const b=await nt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);p(n,ct(new b.default),!0),await t(n).initWorker()});var r=se(),o=$(r);{var w=b=>{var x=Zt();x.__click=[Yt,a],m(b,x)};V(o,b=>{t(a)===E.Stopped&&b(w)})}var d=k(o,2);{var D=b=>{var x=ne(),R=c(x);{var S=j=>{var C=ee();C.__click=[te,a],m(j,C)},L=j=>{var C=re();C.__click=[ae,a],m(j,C)};V(R,j=>{t(a)===E.Paused?j(S):j(L,!1)})}var T=k(R,2);T.__click=[oe,e,n,a],i(x),m(b,x)};V(d,b=>{(t(a)===E.Running||t(a)===E.Paused)&&b(D)})}m(u,r),tt()}at(["click"]);var ie=f("<p>Please select or create an activity to track.</p>"),ce=f('<form><div class="d-flex gap-2 mb-3"><div class="flex-grow-1"><!></div> <div class="flex-grow-1"><!></div></div> <div class="display-1 fw-bold my-3"> <span class="fs-4 align-text-top">s</span></div> <!></form>'),ve=f('<div class="d-flex flex-column align-items-center p-5"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div> <p class="mt-3 mb-0">Please wait while the app loads</p></div>'),ue=f('<div class="settings-container svelte-z6oua9"><button id="settings" class="btn btn-light rounded-circle p-2 lh-1 svelte-z6oua9"><img src="/gear.svg" alt="gear" class="svelte-z6oua9"/></button></div> <main class="container mt-5"><div class="row justify-content-center"><div class="col-md-8 col-lg-6"><!></div> <br/> <div class="col-md-8 col-lg-6 text-center"><!></div></div></main>',1);function ke(u,e){Z(e,!0);const[a,n]=kt(),s=()=>wt(J,"$seconds",a);let r=P("Activity"),o=P("Project"),w=P(""),d=P(null),D=P(K([])),b=P(K([])),x=P(K([])),R=P(K([]));lt(async()=>{const l=await nt(()=>import("../chunks/BVjkO3Q2.js"),[],import.meta.url);p(d,ct(new l.default),!0),await t(d).initWorker(),p(D,await ht(t(d)),!0),p(b,t(D).filter(g=>g.completed==0).map(g=>({id:g.id,name:g.name,isTask:!0})),!0),p(x,await Wt(t(d)),!0);let _=t(x).map(g=>({id:g.id,name:g.name,isTask:!1}));t(b).push(..._),p(R,await Pt(t(d)),!0)});var L=ue(),T=k($(L),2),j=c(T),C=c(j),G=c(C);xt(G,{get dbWorker(){return t(d)},get tasks(){return t(D)}}),i(C);var A=k(C,4),N=c(A);{var v=l=>{var _=ce(),g=c(_),M=c(g),z=c(M);qt(z,{get dbWorker(){return t(d)},get selected(){return t(r)},set selected(y){p(r,y,!0)},get taskAndActivities(){return t(b)},set taskAndActivities(y){p(b,y,!0)}}),i(M);var W=k(M,2),O=c(W);Et(O,{get dbWorker(){return t(d)},get selected(){return t(o)},set selected(y){p(o,y,!0)},get color(){return t(w)},set color(y){p(w,y,!0)},get projects(){return t(R)},set projects(y){p(R,y,!0)}}),i(W),i(g);var B=k(g,2),H=c(B,!0);yt(),i(B);var et=k(B,2);{var _t=y=>{var bt=ie();m(y,bt)},pt=y=>{le(y,{get activityName(){return t(r)},get projectName(){return t(o)}})};V(et,y=>{t(r)==="Activity"?y(_t):y(pt,!1)})}i(_),F(()=>I(H,s())),mt("submit",_,y=>y.preventDefault()),m(l,_)},h=l=>{var _=ve();m(l,_)};V(N,l=>{t(d)?l(v):l(h,!1)})}i(A),i(j),i(T),m(u,L),tt(),n()}export{ke as component};
